<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="generator" content="Mobirise v4.11.4, mobirise.com">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <link rel="shortcut icon" href="assets/images/sharepoint-44x44.png" type="image/x-icon">
    <meta name="description" content="">

    <title>OAuth</title>
    <link rel="stylesheet" href="assets/web/assets/mobirise-icons2/mobirise2.css">
    <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
    <link rel="stylesheet" href="assets/datatables/data-tables.bootstrap4.min.css">
    <link rel="stylesheet" href="assets/tether/tether.min.css">
    <link rel="stylesheet" href="assets/dropdown/css/style.css">
    <link rel="stylesheet" href="assets/theme/css/style.css">
    <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css">
    <link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
</head>
<body>
    <section class="menu cid-rMCUOtwkB5" once="menu" id="menu1-m">
        <nav class="navbar navbar-expand beta-menu navbar-dropdown align-items-center navbar-fixed-top navbar-toggleable-sm bg-color transparent">
            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            <div class="menu-logo">
                <div class="navbar-brand">
                    <span class="navbar-logo">
                        <a href="index.aspx#header6-g">
                            <img src="assets/images/sharepoint-44x44.png" alt="" title="" style="height: 3.8rem;">
                        </a>
                    </span>
                    <span class="navbar-caption-wrap"><a class="navbar-caption text-white display-4" href="index.aspx#header6-g">CSS SharePoint Advanced Learning</a></span>
                </div>
            </div>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true">
                    <li class="nav-item">
                        <a class="nav-link link text-white display-4" href="AboutUs.html">
                            <span class="mobi-mbri mobi-mbri-users mbr-iconfont mbr-iconfont-btn"></span>
                            About Us
                        </a>
                    </li>
                </ul>

            </div>
        </nav>
    </section>
    <section class="engine"><a href="https://mobirise.info/y">free html website templates</a></section><section class="cid-rNhfzbLl10 mbr-fullscreen" id="header2-1i">
        <div class="container align-center">
            <div class="row justify-content-md-center">
                <div class="mbr-white col-md-10">
                    <h1 class="mbr-section-title mbr-bold pb-3 mbr-fonts-style display-1">
                        OAuth 2.0
                    </h1>
                    <p class="mbr-text pb-3 mbr-fonts-style display-5">OAuth 2.0 is the industry-standard protocol for authorization. OAuth 2.0 focuses on client developer simplicity while providing specific authorization flows for web applications, desktop applications, mobile phones, and living room devices.<br>OAuth（Open Authorization，开放授权）是为用户资源的授权定义了一个安全、开放及简单的标准，第三方无需知道用户的账号及密码，就可获取到用户的授权信息<br>OAuth2.0是OAuth协议的延续版本，但不向后兼容OAuth 1.0即完全废止了OAuth1.0<br></p>
                    <div class="mbr-section-btn">
                        <a class="btn btn-md btn-secondary display-4" href="https://oauth.net/2/" target="_blank">More Details</a>
                        <a class="btn btn-md btn-white-outline display-4" href="OAuth.html#content9-1w">Examples</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="mbr-arrow hidden-sm-down" aria-hidden="true">
            <a href="#next">
                <i class="mbri-down mbr-iconfont"></i>
            </a>
        </div>
    </section>
    <section class="mbr-section article content9 cid-rNhnGQHWUX" id="content9-1w">
        <div class="container">
            <div class="inner-container" style="width: 100%;">
                <hr class="line" style="width: 25%;">
                <div class="section-text align-center mbr-fonts-style display-2">
                    <strong>
                        Example 1: WeChat OAuth Flow
                    </strong>
                </div>
                <hr class="line" style="width: 25%;">
            </div>
        </div>
    </section>
    <section class="cid-rNhnBEpfCU" id="image1-1t">
        <figure class="mbr-figure container">
            <div class="image-block" style="width: 66%;">
                <a href="https://www.jianshu.com/p/4f5fcddb4106"><img src="assets/images/wechatoauthflow-1182x948.png" width="1400" alt="" title=""></a>
            </div>
        </figure>
    </section>
    <section class="mbr-section article content9 cid-rNhnFhOQfk" id="content9-1u">
        <div class="container">
            <div class="inner-container" style="width: 100%;">
                <hr class="line" style="width: 25%;">
                <div class="section-text align-center mbr-fonts-style display-2">
                    <strong>
                        Example 2: Azure AD OAuth Flow
                    </strong>
                </div>
                <hr class="line" style="width: 25%;">
            </div>
        </div>
    </section>
    <section class="cid-rNhoJF3OKz" id="image1-1x">
        <figure class="mbr-figure container">
            <div class="image-block" style="width: 66%;">
                <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/v1-protocols-oauth-code"><img src="assets/images/azureadoauthflow-716x817.png" width="1400" alt="" title=""></a>

            </div>
        </figure>
    </section>
    <section class="header11 cid-rNhOWaBzeg mbr-fullscreen" id="header11-1y">
        <div class="container align-left">
            <div class="media-container-column mbr-white col-md-12">
                <h1 class="mbr-section-title py-3 mbr-fonts-style display-1"><strong>Questions</strong>: <br>How to get access token for sharepoint?</h1>
                <p class="mbr-text py-3 mbr-fonts-style display-5">Access token, what does it look like?&nbsp;<br>SharePoint add-in, how to do the authentication?&nbsp;<br>Low trust? <br>High trust?&nbsp;<br>Azure AD registered App?&nbsp;</p>
                <div class="mbr-section-btn py-4"><a class="btn btn-md btn-primary display-4" href="https://mubu.com/doc/fX3v5KLkgG" target="_blank">Mind Map</a></div>
            </div>
        </div>
        <div class="mbr-arrow hidden-sm-down" aria-hidden="true">
            <a href="#next">
                <i class="mbri-down mbr-iconfont"></i>
            </a>
        </div>
    </section>
    <section class="section-table cid-rNkXkORusm mbr-parallax-background" id="table1-27">
        <div class="mbr-overlay" style="opacity: 0.5; background-color: rgb(255, 255, 255);">
        </div>
        <div class="container container-table">
            <h2 class="mbr-section-title mbr-fonts-style align-center pb-3 display-2">Access token, what does it look like?&nbsp;</h2>
            <h3 class="mbr-section-subtitle mbr-fonts-style align-center pb-5 mbr-light display-5">Below is an example of a sharepoint online access token in JWT format, we could also use fiddler or sharepoint ctf to decode an access token</h3>
            <div class="table-wrapper">
                <div class="container">
                    <div class="row search">
                        <div class="col-md-6"></div>
                        <div class="col-md-6">
                            <div class="dataTables_filter">
                                <label class="searchInfo mbr-fonts-style display-7">Filter:</label>
                                <input class="form-control input-sm" disabled="">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container scroll">
                    <table class="table isSearch" cellspacing="0">
                        <thead>
                            <tr class="table-heads ">
                                <th class="head-item mbr-fonts-style display-7">
                                    NAME
                                </th>
                                <th class="head-item mbr-fonts-style display-7">
                                    Description
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="body-item mbr-fonts-style display-7">aud&nbsp;</td>
                                <td class="body-item mbr-fonts-style display-7">Short for “audience”, means the principal the token is intended for. The format is &lt;client ID&gt;/&lt;target URL authority&gt;@&lt;target realm&gt;. Based on this information, you can determine the client ID for your app and the realm.  In an on-premise environment, there is typically just one realm, and its identifier matches your farm ID.  For Office 365, this is your tenant ID.&nbsp;</td>
                            </tr>
                            <tr>
                                <td class="body-item mbr-fonts-style display-7">iss&nbsp;</td>
                                <td class="body-item mbr-fonts-style display-7">Short for “issuer”, this is the principal that issued the token, in the form of &lt;principal ID&gt;@&lt;realm&gt;.  The principal ID value 00000001-0000-0000-c000-000000000000 is ACS. &nbsp;</td>
                            </tr>
                            <tr>
                                <td class="body-item mbr-fonts-style display-7">nbf</td>
                                <td class="body-item mbr-fonts-style display-7">Short for “not before”, this is the number of seconds after January 1, 1970 (part of the JWT specification) that the token starts being valid. &nbsp;</td>
                            </tr>
                            <tr>
                                <td class="body-item mbr-fonts-style display-7">exp&nbsp;</td>
                                <td class="body-item mbr-fonts-style display-7">Short for “expires”, represents the number of seconds after January 1, 1970 that the token stops being valid.&nbsp;</td>
                            </tr>
                            <tr>
                                <td class="body-item mbr-fonts-style display-7">identityprovider</td>
                                <td class="body-item mbr-fonts-style display-7">
                                    The sender of the token in the form &lt;sender ID&gt;@&lt;realm&gt;. For trivia:
                                    <br>ACS: 00000001-0000-0000-c000-000000000000
                                    <br>Exchange: 00000002-0000-0ff1-ce00-000000000000
                                    <br>SharePoint: 00000003-0000-0ff1-ce00-000000000000
                                    <br>Lync: 00000004-0000-0ff1-ce00-000000000000
                                    <br>Workflow: 00000005-0000-0000-c000-000000000000
                                    <br>The realm will be the tenant ID for Office 365, or the farm ID for your on-premise deployment.&nbsp;
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="container table-info-container">
                    <div class="row info">
                        <div class="col-md-6">
                            <div class="dataTables_info mbr-fonts-style display-7">
                                <span class="infoBefore">Showing</span>
                                <span class="inactive infoRows"></span>
                                <span class="infoAfter">entries</span>
                                <span class="infoFilteredBefore">(filtered from</span>
                                <span class="inactive infoRows"></span>
                                <span class="infoFilteredAfter"> total entries)</span>
                            </div>
                        </div>
                        <div class="col-md-6"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="timeline1 cid-rNl3G6NYVs mbr-parallax-background" id="timeline1-2a">
        <div class="mbr-overlay" style="opacity: 0.5; background-color: rgb(204, 204, 204);">
        </div>
        <div class="container align-center">
            <h2 class="mbr-section-title pb-3 mbr-fonts-style display-2">General steps to get an access token for sharepoint</h2>
            <div class="container timelines-container" mbri-timelines="">
                <!--1-->
                <div class="row timeline-element reverse separline">
                    <div class="timeline-date-panel col-xs-12 col-md-6  align-left">
                        <div class="time-line-date-content">
                            <p class="mbr-timeline-date mbr-fonts-style display-5">
                                Step 1
                            </p>
                        </div>
                    </div>
                    <span class="iconBackground"></span>
                    <div class="col-xs-12 col-md-6 align-right">
                        <div class="timeline-text-content">
                            <h4 class="mbr-timeline-title pb-3 mbr-fonts-style display-5">
                                App registeration
                            </h4>
                            <p class="mbr-timeline-text mbr-fonts-style display-7">
                                AppRegNew.aspx<br><br>For sharepoint on prem, it needs to create "App Management service application" and configure the trust at the first place
                            </p>
                        </div>
                    </div>
                </div>
                <!--2-->
                <div class="row timeline-element  separline">
                    <div class="timeline-date-panel col-xs-12 col-md-6 align-right">
                        <div class="time-line-date-content">
                            <p class="mbr-timeline-date mbr-fonts-style display-5">
                                Step 2
                            </p>
                        </div>
                    </div>
                    <span class="iconBackground"></span>
                    <div class="col-xs-12 col-md-6 align-left ">
                        <div class="timeline-text-content">
                            <h4 class="mbr-timeline-title pb-3 mbr-fonts-style display-5">
                                Grant permissions
                            </h4>
                            <p class="mbr-timeline-text mbr-fonts-style display-7">
                                AppInv.aspx<br>
                            </p>
                        </div>
                    </div>
                </div>
                <!--3-->
                <div class="row timeline-element reverse">
                    <div class="timeline-date-panel col-xs-12 col-md-6  align-left">
                        <div class="time-line-date-content">
                            <p class="mbr-timeline-date mbr-fonts-style display-5">
                                Step 3
                            </p>
                        </div>
                    </div>
                    <span class="iconBackground"></span>
                    <div class="col-xs-12 col-md-6 align-right">
                        <div class="timeline-text-content">
                            <h4 class="mbr-timeline-title pb-3 mbr-fonts-style display-5">Contact ACS or STS or Azure</h4>
                            <p class="mbr-timeline-text mbr-fonts-style display-7">TokenHelper<br>PnP AuthenticationManager<br>PnP PowerShell<br>Registered Azure AD App</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="mbr-section article content9 cid-rNlgQFZ4oL" id="content9-2d">
        <div class="container">
            <div class="inner-container" style="width: 100%;">
                <hr class="line" style="width: 25%;">
                <div class="section-text align-center mbr-fonts-style display-5">SharePoint Online by default uses ACS to implement its low trust authentication process, it doesn't have high trust, azure access control service, sharepoint online doesn't trust your add-in but it trusts ACS, your add-in can request the access token via ACS then use it to access sharepoint online resources</div>
                <hr class="line" style="width: 25%;">
            </div>
        </div>
    </section>
    <section class="cid-rNkZwr1srM" id="image1-28">
        <figure class="mbr-figure container">
            <div class="image-block" style="width: 66%;">
                <img src="assets/images/lowtrustflow-1466x774.png" width="1400" alt="" title="">
            </div>
        </figure>
    </section>
    <section class="mbr-section article content9 cid-rNlgR3KvHd" id="content9-2e">
        <div class="container">
            <div class="inner-container" style="width: 100%;">
                <hr class="line" style="width: 25%;">
                <div class="section-text align-center mbr-fonts-style display-5">SharePoint On Prem can use either low trust (above) or High Trust (below), S2S, server to server trust, sharepoint on prem trusts your add-in directly if your add-in can provide the correct information with a certificate</div>
                <hr class="line" style="width: 25%;">
            </div>
        </div>
    </section>
    <section class="cid-rNkZwMIi4f" id="image1-29">
        <figure class="mbr-figure container">
            <div class="image-block" style="width: 66%;">
                <img src="assets/images/hightrustflow-1466x815.png" width="1400" alt="" title="">
            </div>
        </figure>
    </section>

    <section class="header11 cid-rNljcfWtnn mbr-fullscreen" id="header11-2f">
        <div class="container align-left">
            <div class="media-container-column mbr-white col-md-12">
                <h1 class="mbr-section-title py-3 mbr-fonts-style display-1">An option to troubleshoot the errors while getting access token</h1>
                <p class="mbr-text py-3 mbr-fonts-style display-5">
                    Especially when the app is deployed on cloud and fiddler is not applicable
                </p>
                <div class="mbr-section-btn py-4"><a class="btn btn-md btn-white-outline display-4" href="https://github.com/Chunlong101/SharePointTokenHelper" target="_blank">Demo</a></div>
            </div>
        </div>
    </section>
    <section once="footers" class="cid-rMGBivKnuv" id="footer6-o">
        <div class="container">
            <div class="media-container-row align-center mbr-white">
                <div class="col-12">
                    <p class="mbr-text mb-0 mbr-fonts-style display-7">CSS SharePoint 2019 Advanced Learning Program SharePoint Add-in Topic<br>chunlonl@microsoft.com </p>
                </div>
            </div>
        </div>
    </section>

    <script src="assets/popper/popper.min.js"></script>
    <script src="assets/web/assets/jquery/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/smoothscroll/smooth-scroll.js"></script>
    <script src="assets/touchswipe/jquery.touch-swipe.min.js"></script>
    <script src="assets/datatables/jquery.data-tables.min.js"></script>
    <script src="assets/datatables/data-tables.bootstrap4.min.js"></script>
    <script src="assets/parallax/jarallax.min.js"></script>
    <script src="assets/tether/tether.min.js"></script>
    <script src="assets/dropdown/js/nav-dropdown.js"></script>
    <script src="assets/dropdown/js/navbar-dropdown.js"></script>
    <script src="assets/theme/js/script.js"></script>

</body>
</html>